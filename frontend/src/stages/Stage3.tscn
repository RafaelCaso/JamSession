[gd_scene load_steps=13 format=2]

[ext_resource path="res://assets/img/01Stage-02.png" type="Texture" id=1]
[ext_resource path="res://src/stages/StageLight.tscn" type="PackedScene" id=2]
[ext_resource path="res://src/stages/SpeakerBox.tscn" type="PackedScene" id=3]
[ext_resource path="res://src/stages/SpeakerBox2.tscn" type="PackedScene" id=4]
[ext_resource path="res://src/stages/StripLights.tscn" type="PackedScene" id=5]
[ext_resource path="res://src/util/NFTRequest.tscn" type="PackedScene" id=6]
[ext_resource path="res://src/stages/StageEffect01.tscn" type="PackedScene" id=7]
[ext_resource path="res://src/stages/FloodLight.tscn" type="PackedScene" id=8]
[ext_resource path="res://src/stages/Stage3.gd" type="Script" id=9]
[ext_resource path="res://assets/img/logo-dymension-bright.png" type="Texture" id=10]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;

float grid(vec2 uv, float velocity, float iTime)
{
    vec2 size = vec2(uv.y, uv.y * uv.y * 0.2) * 0.01;
    uv += vec2(0.0, iTime * 4.0 * (velocity + 0.05));
    uv = abs(fract(uv) - 0.5);
 	vec2 lines = smoothstep(size, vec2(0.0), uv);
 	lines += smoothstep(size * 5.0, vec2(0.0), uv) * 0.4 * velocity;
    return clamp(lines.x + lines.y, 0.0, 3.0);
}


void fragment()
{
    vec2 uv = (2.0 * FRAGCOORD.xy.xy - (1.0 / SCREEN_PIXEL_SIZE).xy)/(1.0 / SCREEN_PIXEL_SIZE).y;
    float velocity = 0.30;
   
    {
        // Grid
        vec3 col = vec3(0.3, 0.05, 0.3); // Adjusted initial brightness
        if (uv.y < 1.0)
        {
            uv.y = 2.0 / (abs(uv.y + 0.0) * 01.0);
            uv.x *= uv.y - 01.01;
            float gridVal = grid(uv, velocity, TIME);
            col = mix(col, vec3(0.6, 0.2, 0.10), gridVal);
        }

        col = mix(vec3(col.r, col.r, col.r) * 0.53, col,  sin(TIME*0.710)*01.10);

        COLOR = vec4(col,7.0);
    }
}
"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )

[node name="Stage" type="Node2D"]
script = ExtResource( 9 )

[node name="Sprite" type="Sprite" parent="."]
position = Vector2( 960, 540 )
texture = ExtResource( 1 )

[node name="CanvasModulate" type="CanvasModulate" parent="."]
color = Color( 0.278431, 0.439216, 0.443137, 1 )

[node name="SpeakerBox" parent="." instance=ExtResource( 3 )]
position = Vector2( 148, 773 )

[node name="SpeakerBox2" parent="." instance=ExtResource( 4 )]
position = Vector2( 1774, 775 )

[node name="StageLights" type="Node2D" parent="."]

[node name="StageLight" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 118, 97 )

[node name="StageLight2" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 277, 98 )

[node name="StageLight3" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 425, 96 )

[node name="StageLight4" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 584, 97 )

[node name="StageLight5" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 769, 97 )

[node name="StageLight6" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 961, 95 )

[node name="StageLight7" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1154, 98 )

[node name="StageLight8" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1337, 99 )

[node name="StageLight9" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1494, 99 )

[node name="StageLight10" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1645, 97 )

[node name="StageLight11" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1801, 98 )

[node name="StageLight12" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1566, 181 )

[node name="StageLight13" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1601, 181 )

[node name="StageLight14" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1636, 181 )

[node name="StageLight15" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1672, 182 )

[node name="StageLight16" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1565, 219 )

[node name="StageLight17" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1603, 218 )

[node name="StageLight18" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1638, 217 )

[node name="StageLight19" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 1671, 217 )

[node name="StageLight20" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 246, 183 )

[node name="StageLight21" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 283, 181 )

[node name="StageLight22" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 316, 183 )

[node name="StageLight23" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 352, 182 )

[node name="StageLight24" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 246, 219 )

[node name="StageLight25" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 283, 218 )

[node name="StageLight26" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 317, 217 )

[node name="StageLight27" parent="StageLights" instance=ExtResource( 2 )]
position = Vector2( 353, 218 )

[node name="StripLights" parent="." instance=ExtResource( 5 )]
position = Vector2( 946, 925 )
scale = Vector2( 2.5, 1 )

[node name="StripLights2" parent="." instance=ExtResource( 5 )]
position = Vector2( 950, 968 )
scale = Vector2( 0.8, 1 )

[node name="StripLights3" parent="." instance=ExtResource( 5 )]
position = Vector2( 950, 1011 )
scale = Vector2( 0.8, 1 )

[node name="StripLights4" parent="." instance=ExtResource( 5 )]
position = Vector2( 952, 1063 )
scale = Vector2( 0.8, 1 )

[node name="Position2D" type="Position2D" parent="."]
position = Vector2( 679, 338 )

[node name="Position2D2" type="Position2D" parent="."]
position = Vector2( 955, 285 )

[node name="Position2D3" type="Position2D" parent="."]
position = Vector2( 1204, 350 )

[node name="Position2D4" type="Position2D" parent="."]
position = Vector2( 957, 450 )

[node name="StageEffect01" parent="." instance=ExtResource( 7 )]
position = Vector2( 961, 434 )
emission_sphere_radius = 600.0
scale_amount = 0.5

[node name="FloodLight" parent="." instance=ExtResource( 8 )]
visible = false
position = Vector2( 644, 961 )

[node name="FloodLight2" parent="." instance=ExtResource( 8 )]
visible = false
position = Vector2( 1209, 968 )
rotation = -0.174533

[node name="FloodLight3" parent="." instance=ExtResource( 8 )]
visible = false
position = Vector2( 948, 977 )
rotation = 0.0872665

[node name="NFTRequest2" parent="." instance=ExtResource( 6 )]
img_cid = "QmVSYfkGZ2HPhGiPEhZP4gbRDgUtSruzxv7JH9jeheeT5b"
audio_cid = "QmaA6rWFWn64tBgLpQgALqtsar4qNXf5sbHmiDhrS8Qsq7"
coords = Vector2( 1204, 350 )
instrument = "bass"
genre = "metal"

[node name="NFTRequest3" parent="." instance=ExtResource( 6 )]
img_cid = "QmTUAoZkYV5ifkoEgREpfYWGv7GvHk6QTdcj1QcCZxdSyW"
audio_cid = "QmPf9AtvA283mbevSLiPabXPtGKTjUVg59Hha5W2atmHfz"
coords = Vector2( 955, 285 )
instrument = "drums"
genre = "metal"

[node name="TextureButton" type="TextureButton" parent="."]
margin_left = 1699.0
margin_top = 933.0
margin_right = 1918.0
margin_bottom = 1078.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="NFTRequest4" parent="." instance=ExtResource( 6 )]
img_cid = "QmP5x2Wea272WqkEfYognshJkvGqwBYBUKuNSNNFKei4gn"
audio_cid = "QmPx4Ws7uyNY3PgVZPuYjf1VFfeVnBH5eTYzTKoqvwhK8X"
coords = Vector2( 957, 450 )
instrument = "piano"
genre = "jazz"

[node name="Sprite2" type="Sprite" parent="."]
material = SubResource( 2 )
position = Vector2( 961, 347.5 )
scale = Vector2( 1.14906, 2.86325 )
texture = ExtResource( 10 )

[connection signal="button_up" from="TextureButton" to="." method="_on_TextureButton_up"]

[editable path="StripLights"]
